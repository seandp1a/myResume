<div class="container  page-body ">
  <div class="d-flex flex-column align-items-center content-page">
    <h1>UserList</h1>
    <!-- search Bar -->
    <div class="d-block text-center d-md-flex  align-items-center justify-content-center">
      <select class="mx-1 my-2 my-md-0 custom-select  form-control" style="width: 7rem;" [(ngModel)]="searchType">
        <option selected="selceted" value="0">ID</option>
        <option value="1">NAME</option>
        <option value="2">EMAIL</option>
      </select>
      <input class=" mx-1 my-2 my-md-0 form-control w-80" type="text" [(ngModel)]="searchContent"
        [ngbTypeahead]="search" [resultTemplate]="optionBox" [inputFormatter]="formatter" [resultFormatter]="formatter"
        (ngModelChange)="doSearch()">
      <div class="mx-1 my-2 my-md-0 d-flex text-center">
        <button class="mx-3 btn btn-success my-2" style="width: 5rem;" (click)="getUserList()">重整</button>
        <!-- <button class="mx-3 btn btn-success my-2"style="width: 5rem;"
      data-toggle="modal" data-target="#editModal">EDIT</button> -->
        <a routerLink="/userList/register">
          <button class="mx-3 load-more-button my-2" style="width: 5rem;">新增</button>
        </a>
      </div>
    </div>
    <!-- search Bar -->

    <!-- typeahead template -->
    <ng-template #optionBox let-r="result" let-t="term">
      <img [src]="r['image']" width="40px" height="45px" alt="">
      <ngb-highlight [result]="r[searchTypeName]" [term]="t">
      </ngb-highlight>
    </ng-template>
    <!-- typeahead template -->

    <!-- table -->
    <table class="table table-dark table-responsive my-3 user-list d-md-table">
      <thead>
        <tr>
          <th>UserID</th>
          <th class="d-none d-md-table-cell">UserEmail</th>
          <th class="">UserName</th>
          <th class="">CreatedDate</th>
          <th class="d-none d-md-table-cell">Status</th>
        </tr>
      </thead>
      <tbody>
        <tr class="user-tr" *ngFor="let user of userListToView" (click)="open(editModal,user)">
          <td class="col-1 col-md-1 ">{{user.id}}</td>
          <td class=" col-md-4 d-none d-md-table-cell" style="word-wrap:break-all;">{{user.email}}</td>
          <td class="col-9  col-md-3 ">{{user.name}}</td>
          <td class="col-2 col-md-2">{{user.created_at | date:'yyyy-MM-dd' }}</td>
          <td class=" col-md-2 d-none d-md-table-cell">{{user.email_verified_at?'已驗證':'尚未驗證'}}</td>
        </tr>
      </tbody>
    </table>
    <!-- table -->

    <!-- pageNav -->
    <nav aria-label="Page navigation example ">
      <ul class="pagination my-3">
        <li class="page-item" [ngClass]="{disabled:1 === currentPage}">
          <a class="page-link" (click)="renderPage(1)">
            <span aria-hidden="true">∥&#060;</span>
          </a>
        </li>
        <li class="page-item" [ngClass]="{disabled:1 === currentPage}">
          <a class="page-link" (click)="renderPage(currentPage-1)">
            <span aria-hidden="true">&laquo;</span>
          </a>
        </li>
        <li class="page-item" [ngClass]="{active:item === currentPage}" *ngFor="let item of pageArr">
          <a class="page-link" (click)="renderPage(item)">{{item}}</a>
        </li>
        <li class="page-item" [ngClass]="{disabled:totalPage === currentPage}">
          <a class="page-link" (click)="renderPage(currentPage+1)">
            <span aria-hidden="true">&raquo;</span>
          </a>
        </li>
        <li class="page-item" [ngClass]="{disabled:totalPage === currentPage}">
          <a class="page-link" (click)="renderPage(totalPage)">
            <span aria-hidden="true">&#062;∥</span>
          </a>
        </li>
      </ul>
    </nav>
    <!-- pageNav -->

    <!-- Modal -->

    <ng-template #editModal let-modal>
      <div class="modal-header">
        <h4 class="modal-title" id="modal-basic-title">更新資料</h4>
        <button type="button" class="close" aria-label="Close" (click)="modal.dismiss('Cross click')">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <ngb-alert class="myalert" [type]="alertType" [dismissible]="false" *ngIf="!formChanged">{{alertText}}
        </ngb-alert>

        <form [formGroup]="editFormGroup">
          <div class="form-group">
            <div class="d-flex">
              <div class="avatar col-6 col-md-5 "
                [ngStyle]="{backgroundImage:imgFile?'none':'url('+ tempUserImage+')'}">
                <input type="file" accept="image/*" class="fileInput" (change)="onFileChange($event)">
                <img [src]="imgFile" *ngIf="imgFile">
              </div>

              <div class="col-6 col-md-7">
                <label for="userId">User Id</label>
                <input id="userId" formControlName="id" class="form-control">
                <label for="userName">User Name</label>
                <input id="userName" formControlName="name" class="form-control">
              </div>
            </div>
          </div>
          <div class="form-group">
            <div class="d-flex">
              <div class="col-12">
                <label for="userEmail">User Email</label>
                <input id="userEmail" formControlName="email" class="form-control">
              </div>
            </div>
          </div>
          <!-- <div class="form-group">
          <div class="d-flex">
            <div class="col-12">
              <label for="userPassword" >New Password</label>
              <input id="userPassword" type="password" formControlName="password" class="form-control" >
            </div>
          </div>
        </div> -->

        </form>
      </div>
      <div class="modal-footer px-4">
        <button type="button" class="btn btn-outline-danger mr-auto" (click)="doDelete(modal)">Delete</button>
        <button type="button" class="btn btn-outline-dark" (click)="doUpdate(modal)">Update</button>
      </div>
    </ng-template>
    <!-- Modal -->

  </div>
</div>
